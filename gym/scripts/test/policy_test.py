import torch
import numpy as np

jit_policy = torch.jit.load(
    "/home/hpx/HPX_Loco/foot_step/logs/U_H1_R/exported/policy_lstm_1.pt"
)

obs_0 = [
    0.00000000052064413891272920409392,
    -0.00000000713785652806109283119440,
    -0.00000000037102051986259709792648,
    0.00000000064479505068604225925810,
    -0.00000000009362308150961951014324,
    -1.00000000000000000000000000000000,
    0.00000000000000000000000000000000,
    0.00000000000000000000000000000000,
    0.00000000000000000000000000000000,
    0.22252094745635986328125000000000,
    0.97492790222167968750000000000000,
    -0.00000000004295690539390939477471,
    0.00000000013777617935417652006436,
    -0.00000000000295429240966538220192,
    0.00000000000252137546952191371474,
    -0.00000000003305514195695025136956,
    -0.00000000000028854441622497284392,
    -0.00000000003589113034552227077256,
    0.00000000014124378056035169493043,
    -0.00000000000949033386599129613614,
    -0.00000000004201766018452346429513,
    -0.00000000003343674295774867744058,
    0.00000000000040176100835932759825,
    -0.00000000445036052454383934673388,
    0.00000001027653429019892428186722,
    -0.00000000021358047275210623183739,
    0.00000000204506456213948695221916,
    -0.00000000272831823799890571535798,
    -0.00000000002381252313388149133289,
    -0.00000000336293237701568159536691,
    0.00000001173972119516974998987280,
    -0.00000000083727091926277807942824,
    -0.00000000408090183867670930339955,
    -0.00000000281738921081853277428309,
    0.00000000003427818098811208358256,
    0.00000000066168087675677611514402,
    0.16300010681152343750000000000000,
    -1.01920354366302490234375000000000,
    0.00000000000000000000000000000000,
    0.00000000065267402593605083893635,
    -0.16300010681152343750000000000000,
    -1.01920366287231445312500000000000,
    0.00000004817513143962059984914958,
    0.00000000000000000000000000000000,
]
action_0 = [
    -0.05087916553020477294921875000000,
    0.03287274017930030822753906250000,
    0.17852380871772766113281250000000,
    -0.09197390079498291015625000000000,
    1.77595627307891845703125000000000,
    1.93549489974975585937500000000000,
    -0.02496123313903808593750000000000,
    -0.20008540153503417968750000000000,
    0.31484538316726684570312500000000,
    0.40020579099655151367187500000000,
    -1.45385837554931640625000000000000,
    -0.46987956762313842773437500000000,
]
obs_1 = [
    -0.45969945192337036132812500000000,
    0.31564202904701232910156250000000,
    -0.33803865313529968261718750000000,
    0.00392124149948358535766601562500,
    0.00516381207853555679321289062500,
    -0.99997889995574951171875000000000,
    0.00000000000000000000000000000000,
    0.00000000000000000000000000000000,
    0.00000000000000000000000000000000,
    0.43388375639915466308593750000000,
    0.90096884965896606445312500000000,
    -0.01976456120610237121582031250000,
    0.00825690943747758865356445312500,
    0.01223074551671743392944335937500,
    -0.03717371448874473571777343750000,
    0.13328149914741516113281250000000,
    0.10696792602539062500000000000000,
    -0.02270919829607009887695312500000,
    -0.06141075491905212402343750000000,
    0.01610569842159748077392578125000,
    0.15185233950614929199218750000000,
    -0.12875965237617492675781250000000,
    -0.04430062323808670043945312500000,
    -1.55217528343200683593750000000000,
    0.63309073448181152343750000000000,
    1.08705866336822509765625000000000,
    -2.77857112884521484375000000000000,
    9.00881195068359375000000000000000,
    9.00534057617187500000000000000000,
    -1.61688530445098876953125000000000,
    -4.67789793014526367187500000000000,
    1.44044339656829833984375000000000,
    11.55817031860351562500000000000000,
    -9.00583362579345703125000000000000,
    -3.66000294685363769531250000000000,
    0.00377972214482724666595458984375,
    0.17764945328235626220703125000000,
    -1.01983833312988281250000000000000,
    -0.01791620254516601562500000000000,
    -0.01059513445943593978881835937500,
    -0.15109929442405700683593750000000,
    -1.01060688495635986328125000000000,
    -0.02052879333496093750000000000000,
    0.00000000000000000000000000000000,
]
action_1 = [
    0.01924295723438262939453125000000,
    -0.03700128570199012756347656250000,
    -0.13136622309684753417968750000000,
    0.02156448364257812500000000000000,
    1.50019729137420654296875000000000,
    2.42682504653930664062500000000000,
    0.11596290767192840576171875000000,
    0.11044599115848541259765625000000,
    -0.15421815216541290283203125000000,
    0.10933618992567062377929687500000,
    -0.84821897745132446289062500000000,
    -0.92588680982589721679687500000000,
]

obs_2 = [
    0.29300716519355773925781250000000,
    0.10797556489706039428710937500000,
    -0.08117206394672393798828125000000,
    0.00783324148505926132202148437500,
    0.00639023259282112121582031250000,
    -0.99994856119155883789062500000000,
    0.00000000000000000000000000000000,
    0.00000000000000000000000000000000,
    0.00000000000000000000000000000000,
    0.62348985671997070312500000000000,
    0.78183150291442871093750000000000,
    -0.02451874129474163055419921875000,
    0.01377147436141967773437500000000,
    0.01158444397151470184326171875000,
    -0.05836767703294754028320312500000,
    0.18748562037944793701171875000000,
    0.26180973649024963378906250000000,
    0.00629978906363248825073242187500,
    -0.10244309157133102416992187500000,
    0.02575285546481609344482421875000,
    0.26963108777999877929687500000000,
    -0.30895587801933288574218750000000,
    -0.17833594977855682373046875000000,
    1.45131409168243408203125000000000,
    0.02035209164023399353027343750000,
    -0.62959402799606323242187500000000,
    -0.10845474898815155029296875000000,
    -2.42854309082031250000000000000000,
    -0.05494512617588043212890625000000,
    3.42135667800903320312500000000000,
    -0.03890889883041381835937500000000,
    -0.31017246842384338378906250000000,
    1.46134197711944580078125000000000,
    -8.99237728118896484375000000000000,
    -8.59217834472656250000000000000000,
    0.00628054980188608169555664062500,
    0.18310914933681488037109375000000,
    -1.01896262168884277343750000000000,
    -0.02280569076538085937500000000000,
    -0.01642378792166709899902343750000,
    -0.14918741583824157714843750000000,
    -0.99952208995819091796875000000000,
    0.00877940375357866287231445312500,
    0.00000000000000000000000000000000,
]
action_2 = [
    0.07494050264358520507812500000000,
    0.20476928353309631347656250000000,
    0.57685464620590209960937500000000,
    0.07460294663906097412109375000000,
    1.62347352504730224609375000000000,
    2.95795011520385742187500000000000,
    0.05647869408130645751953125000000,
    -0.06027235835790634155273437500000,
    0.13218116760253906250000000000000,
    0.18570587038993835449218750000000,
    -1.02655100822448730468750000000000,
    -1.32367157936096191406250000000000,
]
a = torch.tensor([obs_0])
print(a.size())
j_action_0 = jit_policy(torch.tensor([obs_0]))[0].detach().numpy()
j_action_1 = jit_policy(torch.tensor([obs_1]))[0].detach().numpy()
j_action_2 = jit_policy(torch.tensor([obs_2]))[0].detach().numpy()
np.set_printoptions(floatmode='maxprec')

print(j_action_0,"\r\n",action_0)
print(j_action_1,"\r\n",action_1)
print(j_action_2,"\r\n",action_2)